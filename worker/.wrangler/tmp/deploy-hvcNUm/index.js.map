{
  "version": 3,
  "sources": ["../../../src/index.ts"],
  "sourceRoot": "E:\\ICML Paper\\topa-expert-survey\\worker\\.wrangler\\tmp\\deploy-hvcNUm",
  "sourcesContent": ["export type Env = {\r\n  DB: D1Database; // <-- D1 binding name in wrangler.toml\r\n  TOKEN_SECRET: string;\r\n  ALLOWED_ORIGINS: string; // comma-separated origins like https://USER.github.io\r\n};\r\n\r\nfunction cors(origin: string) {\r\n  return {\r\n    \"Access-Control-Allow-Origin\": origin,\r\n    \"Access-Control-Allow-Methods\": \"POST,OPTIONS\",\r\n    \"Access-Control-Allow-Headers\": \"Content-Type\",\r\n    \"Access-Control-Max-Age\": \"86400\",\r\n    \"Content-Type\": \"application/json\",\r\n  };\r\n}\r\n\r\nfunction originAllowed(env: Env, origin: string) {\r\n  const allowed = (env.ALLOWED_ORIGINS || \"\")\r\n    .split(\",\")\r\n    .map((s) => s.trim())\r\n    .filter(Boolean);\r\n  return origin && allowed.includes(origin);\r\n}\r\n\r\nfunction base64UrlEncode(bytes: Uint8Array) {\r\n  let s = \"\";\r\n  for (const b of bytes) s += String.fromCharCode(b);\r\n  return btoa(s).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/g, \"\");\r\n}\r\n\r\nfunction base64UrlEncodeString(str: string) {\r\n  return base64UrlEncode(new TextEncoder().encode(str));\r\n}\r\n\r\nasync function sha256Hex(s: string) {\r\n  const bytes = new TextEncoder().encode(s);\r\n  const digest = await crypto.subtle.digest(\"SHA-256\", bytes);\r\n  return [...new Uint8Array(digest)]\r\n    .map((b) => b.toString(16).padStart(2, \"0\"))\r\n    .join(\"\");\r\n}\r\n\r\n// ---- simple HMAC token (for survey session) ----\r\nasync function hmacSign(secret: string, data: string) {\r\n  const key = await crypto.subtle.importKey(\r\n    \"raw\",\r\n    new TextEncoder().encode(secret),\r\n    { name: \"HMAC\", hash: \"SHA-256\" },\r\n    false,\r\n    [\"sign\"]\r\n  );\r\n  const sig = await crypto.subtle.sign(\"HMAC\", key, new TextEncoder().encode(data));\r\n  return base64UrlEncode(new Uint8Array(sig));\r\n}\r\n\r\nfunction b64Json(obj: any) {\r\n  return base64UrlEncode(new TextEncoder().encode(JSON.stringify(obj)));\r\n}\r\n\r\nfunction fromB64Json(s: string) {\r\n  const b64 = s.replace(/-/g, \"+\").replace(/_/g, \"/\") + \"===\".slice((s.length + 3) % 4);\r\n  const raw = atob(b64);\r\n  const bytes = new Uint8Array(raw.length);\r\n  for (let i = 0; i < raw.length; i++) bytes[i] = raw.charCodeAt(i);\r\n  return JSON.parse(new TextDecoder().decode(bytes));\r\n}\r\n\r\nasync function makeToken(env: Env, payload: any) {\r\n  const body = b64Json(payload);\r\n  const sig = await hmacSign(env.TOKEN_SECRET, body);\r\n  return `${body}.${sig}`;\r\n}\r\n\r\nasync function verifyToken(env: Env, token: string) {\r\n  const [body, sig] = token.split(\".\");\r\n  if (!body || !sig) throw new Error(\"Bad token format\");\r\n  const expected = await hmacSign(env.TOKEN_SECRET, body);\r\n  if (expected !== sig) throw new Error(\"Bad token signature\");\r\n  const payload = fromB64Json(body);\r\n  if (payload.exp && Date.now() > payload.exp) throw new Error(\"Token expired\");\r\n  return payload;\r\n}\r\n\r\n// ---- D1 helpers ----\r\ntype AccessCodeRow = {\r\n  code_hash: string;\r\n  active: number; // 0/1\r\n  uses_remaining: number | null;\r\n  expires_at: string | null;\r\n};\r\n\r\nasync function dbGetAccessCode(env: Env, codeHash: string): Promise<AccessCodeRow | null> {\r\n  const row = await env.DB\r\n    .prepare(\"SELECT code_hash, active, uses_remaining, expires_at FROM access_codes WHERE code_hash = ?\")\r\n    .bind(codeHash)\r\n    .first<AccessCodeRow>();\r\n\r\n  return row ?? null;\r\n}\r\n\r\nasync function dbDecrementUsesRemaining(env: Env, codeHash: string): Promise<void> {\r\n  // Only decrement if uses_remaining is not NULL and > 0\r\n  await env.DB\r\n    .prepare(\r\n      \"UPDATE access_codes SET uses_remaining = uses_remaining - 1 WHERE code_hash = ? AND uses_remaining IS NOT NULL AND uses_remaining > 0\"\r\n    )\r\n    .bind(codeHash)\r\n    .run();\r\n}\r\n\r\ntype VoteRow = {\r\n  id: string;\r\n  participant_id: string;\r\n  component: string;\r\n  trial_id: number;\r\n  left_method_id: string;\r\n  right_method_id: string;\r\n  preferred: string; // we will store normalized \"left\" | \"right\"\r\n  timestamp_utc: string;\r\n  user_agent?: string;\r\n  page_url?: string;\r\n  received_at: string;\r\n};\r\n\r\nfunction normalizePreferred(p: string): \"left\" | \"right\" {\r\n  const v = (p || \"\").toLowerCase().trim();\r\n  // accept older naming too\r\n  if (v === \"left\" || v === \"top\") return \"left\";\r\n  if (v === \"right\" || v === \"bottom\") return \"right\";\r\n  // fallback: keep it strict to avoid DB CHECK failures\r\n  throw new Error(\"preferred must be one of: left/right (or top/bottom)\");\r\n}\r\n\r\nasync function dbUpsertVote(env: Env, row: VoteRow): Promise<void> {\r\n  // Upsert using SQLite ON CONFLICT\r\n  await env.DB\r\n    .prepare(`\r\n      INSERT INTO votes (\r\n        id, participant_id, component, trial_id,\r\n        left_method_id, right_method_id, preferred, timestamp_utc,\r\n        user_agent, page_url, received_at\r\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\r\n      ON CONFLICT(id) DO UPDATE SET\r\n        participant_id=excluded.participant_id,\r\n        component=excluded.component,\r\n        trial_id=excluded.trial_id,\r\n        left_method_id=excluded.left_method_id,\r\n        right_method_id=excluded.right_method_id,\r\n        preferred=excluded.preferred,\r\n        timestamp_utc=excluded.timestamp_utc,\r\n        user_agent=excluded.user_agent,\r\n        page_url=excluded.page_url,\r\n        received_at=excluded.received_at\r\n    `)\r\n    .bind(\r\n      row.id,\r\n      row.participant_id,\r\n      row.component,\r\n      row.trial_id,\r\n      row.left_method_id,\r\n      row.right_method_id,\r\n      row.preferred,\r\n      row.timestamp_utc,\r\n      row.user_agent ?? \"\",\r\n      row.page_url ?? \"\",\r\n      row.received_at\r\n    )\r\n    .run();\r\n}\r\n\r\nexport default {\r\n  async fetch(req: Request, env: Env): Promise<Response> {\r\n    const origin = req.headers.get(\"Origin\") || \"\";\r\n\r\n    if (req.method === \"OPTIONS\") {\r\n      return new Response(null, {\r\n        status: 204,\r\n        headers: originAllowed(env, origin) ? cors(origin) : {},\r\n      });\r\n    }\r\n\r\n    if (!originAllowed(env, origin)) {\r\n      return new Response(JSON.stringify({ error: \"Origin not allowed\" }), {\r\n        status: 403,\r\n        headers: cors(origin),\r\n      });\r\n    }\r\n\r\n    if (req.method !== \"POST\") {\r\n      return new Response(JSON.stringify({ error: \"Method not allowed\" }), {\r\n        status: 405,\r\n        headers: cors(origin),\r\n      });\r\n    }\r\n\r\n    const url = new URL(req.url);\r\n    const path = url.pathname;\r\n\r\n    // POST /api/start\r\n    if (path.endsWith(\"/api/start\")) {\r\n      const body = await req.json().catch(() => ({}));\r\n      const code = String(body.code || \"\").trim();\r\n      if (!code) {\r\n        return new Response(JSON.stringify({ error: \"Missing code\" }), { status: 400, headers: cors(origin) });\r\n      }\r\n\r\n      const codeHash = await sha256Hex(code);\r\n\r\n      const doc = await dbGetAccessCode(env, codeHash);\r\n      if (!doc) {\r\n        return new Response(JSON.stringify({ error: \"Invalid code\" }), { status: 403, headers: cors(origin) });\r\n      }\r\n\r\n      const active = doc.active === 1;\r\n      if (!active) {\r\n        return new Response(JSON.stringify({ error: \"Code inactive\" }), { status: 403, headers: cors(origin) });\r\n      }\r\n\r\n      if (doc.uses_remaining !== null && doc.uses_remaining <= 0) {\r\n        return new Response(JSON.stringify({ error: \"Code has no remaining uses\" }), {\r\n          status: 403,\r\n          headers: cors(origin),\r\n        });\r\n      }\r\n\r\n      if (doc.expires_at) {\r\n        const expMs = Date.parse(doc.expires_at);\r\n        if (!Number.isFinite(expMs)) {\r\n          return new Response(JSON.stringify({ error: \"Bad expires_at format in DB\" }), {\r\n            status: 500,\r\n            headers: cors(origin),\r\n          });\r\n        }\r\n        if (Date.now() > expMs) {\r\n          return new Response(JSON.stringify({ error: \"Code expired\" }), { status: 403, headers: cors(origin) });\r\n        }\r\n      }\r\n\r\n      // decrement uses_remaining if present\r\n      if (doc.uses_remaining !== null) {\r\n        await dbDecrementUsesRemaining(env, codeHash);\r\n      }\r\n\r\n      const token = await makeToken(env, { codeHash, exp: Date.now() + 12 * 60 * 60 * 1000 });\r\n      return new Response(JSON.stringify({ ok: true, token }), { status: 200, headers: cors(origin) });\r\n    }\r\n\r\n    // POST /api/vote\r\n    if (path.endsWith(\"/api/vote\")) {\r\n      const body = await req.json().catch(() => ({}));\r\n      const token = String(body.token || \"\");\r\n      const vote = body.vote;\r\n\r\n      if (!token || !vote) {\r\n        return new Response(JSON.stringify({ error: \"Missing token or vote\" }), { status: 400, headers: cors(origin) });\r\n      }\r\n\r\n      try {\r\n        await verifyToken(env, token);\r\n      } catch (e: any) {\r\n        return new Response(JSON.stringify({ error: e.message || \"Invalid token\" }), { status: 403, headers: cors(origin) });\r\n      }\r\n\r\n      const required = [\"participant_id\", \"component\", \"trial_id\", \"left_method_id\", \"right_method_id\", \"preferred\", \"timestamp_utc\"];\r\n      for (const k of required) {\r\n        if (vote[k] === undefined || vote[k] === null || vote[k] === \"\") {\r\n          return new Response(JSON.stringify({ error: `Missing field: ${k}` }), { status: 400, headers: cors(origin) });\r\n        }\r\n      }\r\n\r\n      let preferred: \"left\" | \"right\";\r\n      try {\r\n        preferred = normalizePreferred(String(vote.preferred));\r\n      } catch (e: any) {\r\n        return new Response(JSON.stringify({ error: e.message }), { status: 400, headers: cors(origin) });\r\n      }\r\n\r\n      const participant = String(vote.participant_id);\r\n      const component = String(vote.component);\r\n      const trial = Number(vote.trial_id);\r\n\r\n      const docId = `${participant}__${component}__${trial}`; // safe primary key\r\n\r\n      const row: VoteRow = {\r\n        id: docId,\r\n        participant_id: participant,\r\n        component,\r\n        trial_id: trial,\r\n        left_method_id: String(vote.left_method_id),\r\n        right_method_id: String(vote.right_method_id),\r\n        preferred,\r\n        timestamp_utc: String(vote.timestamp_utc),\r\n        user_agent: String(vote.user_agent || \"\"),\r\n        page_url: String(vote.page_url || \"\"),\r\n        received_at: new Date().toISOString(),\r\n      };\r\n\r\n      await dbUpsertVote(env, row);\r\n      return new Response(JSON.stringify({ ok: true }), { status: 200, headers: cors(origin) });\r\n    }\r\n\r\n    return new Response(JSON.stringify({ error: \"Not found\" }), { status: 404, headers: cors(origin) });\r\n  },\r\n};\r\n"],
  "mappings": "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",
  "names": []
}
